<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SmartCloudPark Dashboard</title>
<style>
  body {
    margin: 0;
    background: #050505;
    font-family: Arial, sans-serif;
    color: white;
    text-align: center;
  }

  h1 {
    color: #00eaff;
    margin-top: 20px;
    text-shadow: 0 0 12px #00eaff;
  }

  .slots-grid {
    margin: 40px auto;
    width: 90%;
    max-width: 900px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 20px;
  }

  .slot {
    padding: 2px;
    border-radius: 14px;
    background: linear-gradient(180deg, #222, #111);
    box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
  }

  .slot .inner {
    border-radius: 12px;
    padding: 25px 0;
    font-size: 22px;
    font-weight: bold;
  }

  /* ✅ FREE = GREEN */
  .slot.free .inner {
    background: linear-gradient(180deg, rgba(34,197,94,0.10), rgba(16,185,129,0.06));
    color: #00ff66;
    text-shadow: 0 0 8px #00ff66;
  }

  /* ✅ OCCUPIED = RED */
  .slot.occ .inner {
    background: linear-gradient(180deg, rgba(239,68,68,0.10), rgba(220,38,38,0.06));
    color: #ff4d4d;
    text-shadow: 0 0 8px #ff4d4d;
  }

  .bottom {
    margin-top: 8px;
    height: 6px;
    border-radius: 10px;
  }
</style>
</head>

<body>
<h1>SmartCloudPark Dashboard</h1>
<div id="slots" class="slots-grid"></div>

<script type="module">
  const SUPABASE_URL = "https://ipzpjtoyicberwrvdpgd.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlwenBqdG95aWNiZXJ3cnZkcGdkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMyODE2NDgsImV4cCI6MjA3ODg1NzY0OH0.IRr_e6X8E49caJEIZGvHTZleLxMyxwXGkHyoDJjzWK4";

  const gradients = [
    "linear-gradient(90deg,#16a34a,#34d399)", // green
    "linear-gradient(90deg,#ef4444,#fb7185)", // red
    "linear-gradient(90deg,#16a34a,#ef4444)"  // mixed
  ];

  async function loadSlots() {
    const response = await fetch(`${SUPABASE_URL}/rest/v1/parking_slots?select=*`, {
      headers: { apikey: SUPABASE_KEY }
    });
    const slots = await response.json();

    const container = document.getElementById("slots");
    container.innerHTML = "";

    slots.forEach((slot, index) => {
      const state = slot.is_free ? "free" : "occ";
      const bottomColor = gradients[index % gradients.length];

      const div = document.createElement("div");
      div.className = `slot ${state}`;
      div.innerHTML = `
        <div class="inner">${slot.slot_id}</div>
        <div class="bottom" style="background:${bottomColor}"></div>
      `;
      container.appendChild(div);
    });
  }

  loadSlots();
  setInterval(loadSlots, 2000); 
</script>
</body>
</html>

